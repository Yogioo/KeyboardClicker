# 多屏幕支持功能说明

## 概述

本次更新为键盘点击屏幕工具添加了完整的多屏幕支持功能，解决了在多显示器环境下无法正常工作的问题。

## 主要改进

### 1. 屏幕检测功能
- **自动检测多屏幕环境**：程序启动时自动检测所有连接的显示器
- **获取虚拟屏幕尺寸**：支持获取跨多个显示器的总屏幕尺寸
- **屏幕边界计算**：准确计算所有屏幕的有效坐标范围

### 2. 坐标验证增强
- **多屏幕坐标验证**：支持验证跨多个显示器的坐标有效性
- **负坐标处理**：正确处理扩展显示器可能出现的负坐标
- **边界检查**：精确的屏幕边界检查，防止点击超出屏幕范围

### 3. 点击功能优化
- **多屏幕点击支持**：可以在任意显示器上执行点击操作
- **坐标转换**：自动处理不同显示器间的坐标转换
- **错误处理**：增强的错误处理机制，提供详细的错误信息

### 4. 用户界面改进
- **屏幕信息显示**：实时显示当前检测到的屏幕信息
- **刷新功能**：支持手动刷新屏幕信息（用于热插拔显示器）
- **状态提示**：显示屏幕数量和总分辨率信息

## 技术实现

### 核心技术
1. **tkinter屏幕检测**：使用tkinter获取虚拟屏幕信息
2. **pyautogui增强**：改进pyautogui的多屏幕坐标处理
3. **动态屏幕信息**：支持运行时刷新屏幕配置

### 关键代码改进
- `_get_screen_info()`: 获取多屏幕信息
- `validate_coordinates()`: 多屏幕坐标验证
- `perform_click()`: 增强的点击功能
- `refresh_screen_info()`: 动态刷新屏幕信息

## 使用说明

### 基本使用
1. 启动程序后，界面会自动显示当前屏幕配置
2. 屏幕信息格式：`宽度x高度 (屏幕数量)`
3. 可以点击"刷新"按钮更新屏幕信息

### 多屏幕环境
- **主屏幕**：坐标从(0,0)开始
- **扩展屏幕**：坐标可能为负数或大于主屏幕尺寸
- **负坐标说明**：当扩展屏幕位于主屏幕左侧时，会出现负坐标，这是正常现象
- **坐标获取**："获取当前位置"按钮可以获取任意屏幕上的鼠标坐标

### 坐标显示说明
- **正坐标**：鼠标在主屏幕或右侧扩展屏幕上
- **负坐标**：鼠标在左侧扩展屏幕上（例如：(-1000, 500)表示在左侧屏幕）
- **坐标范围**：程序会自动检测所有屏幕的坐标范围，包括负坐标区域

### 测试功能
运行 `test_multiscreen.py` 可以测试多屏幕功能：
```bash
python test_multiscreen.py
```

## 兼容性

- **单屏幕环境**：完全向后兼容，功能不受影响
- **多屏幕环境**：支持2-4个显示器的常见配置
- **热插拔**：支持运行时添加/移除显示器（需手动刷新）

## 故障排除

### 常见问题
1. **坐标无效**：检查目标坐标是否在屏幕范围内
2. **点击失效**：确认目标显示器已正确连接
3. **屏幕信息错误**：点击"刷新"按钮更新屏幕信息
4. **显示负坐标**：这是正常现象，表示鼠标在左侧扩展屏幕上
5. **坐标跳跃**：在多屏幕间移动鼠标时坐标会有较大变化，属于正常现象

### 调试方法
- 运行测试脚本查看详细的屏幕信息
- 检查状态栏显示的屏幕配置
- 验证鼠标位置是否正确显示

## 更新日志

### v2.0 - 多屏幕支持
- ✅ 添加多屏幕检测功能
- ✅ 增强坐标验证机制
- ✅ 优化点击功能
- ✅ 改进用户界面
- ✅ 添加测试脚本
- ✅ 支持屏幕信息刷新

---

**注意**：本功能已在Windows环境下测试通过，支持常见的多显示器配置。如遇到问题，请运行测试脚本进行诊断。